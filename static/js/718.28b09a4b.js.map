{"version":3,"file":"718.28b09a4b.js","mappings":"4JAKe,MAAMA,EACnBC,WAAAA,CAAYC,EAAU,CAAC,GACrBC,KAAKD,QAAU,CACbE,WAAY,WACZC,UAAW,IACXC,cAAe,0CACfC,mBAAoB,gBACpBC,cAAe,kBACfC,eAAgB,mBAChBC,YAAa,cACbC,aAAc,eACdC,WAAY,aACZC,eAAgB,IAChBC,cAAe,EACfC,WAAY,IACZC,YAAY,EACZC,oBAAoB,EACpBC,yBAAyB,KACtBhB,GAGLC,KAAKgB,SAAW,KAChBhB,KAAKiB,WAAa,IAAIC,IACtBlB,KAAKmB,YAAc,IAAIC,IACvBpB,KAAKqB,eAAgB,EAErBrB,KAAKsB,MACP,CAEAA,IAAAA,GAEEtB,KAAKuB,mBAGLvB,KAAKwB,8BAGLxB,KAAKyB,uBAGP,CAEAF,gBAAAA,GACE,IAAKvB,KAAKD,QAAQc,WAEhB,YADAb,KAAKqB,eAAgB,GAIvB,MAAMK,EAASC,SAASC,cAAc,UACtCF,EAAOG,MAAQ,EACfH,EAAOI,OAAS,EAChB9B,KAAKqB,cAAyE,IAAzDK,EAAOK,UAAU,cAAcC,QAAQ,cAG5DL,SAASM,gBAAgBC,UAAUC,IAAInC,KAAKqB,cAAgB,iBAAmB,UACjF,CAEAG,2BAAAA,GAEEG,SAASM,gBAAgBC,UAAUC,IAAI,gBAGvCnC,KAAKoC,mBAGDpC,KAAKD,QAAQe,oBACfd,KAAKqC,mBAET,CAEAD,gBAAAA,GACE,MAAME,EAAQX,SAASC,cAAc,SACrCU,EAAMC,YAAc,8FAGMvC,KAAKD,QAAQW,k7BAqCvCiB,SAASa,KAAKC,YAAYH,EAC5B,CAEAD,iBAAAA,GACiBV,SAASe,iBAAiB1C,KAAKD,QAAQI,eAC/CwC,QAAQC,KACRA,EAAIC,KAAOD,EAAIE,QAAQD,MAE1BD,EAAIV,UAAUC,IAAI,oBAGdS,EAAIE,QAAQC,YACdH,EAAIC,IAAMD,EAAIE,QAAQC,YAGtB/C,KAAKgD,oBAAoBJ,KAIjC,CAEAI,mBAAAA,CAAoBJ,GAElB,MAAMf,EAAQe,EAAIK,aAAa,UAAY,IACrCnB,EAASc,EAAIK,aAAa,WAAa,IAGvCF,EAAc,qFAAqFlB,cAAkBC,mBAAwBD,KAASC,6EAE5Jc,EAAIC,IAAME,CACZ,CAEAtB,qBAAAA,GAEMzB,KAAKD,QAAQgB,yBAA2B,YAAamC,iBAAiBC,UACxEnD,KAAKoD,wBAGE,yBAA0BC,OACjCrD,KAAKsD,2BAILtD,KAAKuD,4BAET,CAEAH,qBAAAA,GACiBzB,SAASe,iBAAiB1C,KAAKD,QAAQI,eAC/CwC,QAAQC,IACTA,EAAIE,QAAQD,MACdD,EAAIC,IAAM7C,KAAKwD,sBAAsBZ,GACrCA,EAAIa,QAAU,OACdb,EAAIV,UAAUC,IAAInC,KAAKD,QAAQQ,aAC/BP,KAAK0D,gBAAgBd,MAKzB5C,KAAKsD,0BACP,CAEAA,wBAAAA,GACEtD,KAAKgB,SAAW,IAAI2C,qBAClBC,IACEA,EAAQjB,QAAQkB,IACVA,EAAMC,iBACR9D,KAAK+D,YAAYF,EAAMG,QACvBhE,KAAKgB,SAASiD,UAAUJ,EAAMG,YAIpC,CACE/D,WAAYD,KAAKD,QAAQE,WACzBC,UAAWF,KAAKD,QAAQG,YAK5BF,KAAKkE,iBACP,CAEAA,eAAAA,GACmBvC,SAASe,iBAAiB,WACvC1C,KAAKD,QAAQI,yBACbH,KAAKD,QAAQK,8BACbJ,KAAKD,QAAQM,yBACbL,KAAKD,QAAQO,wBAGRqC,QAAQwB,IACVnE,KAAKmB,YAAYiD,IAAID,IACxBnE,KAAKgB,SAASqD,QAAQF,IAG5B,CAEAZ,0BAAAA,GACE,MAAMe,EAAW3C,SAASe,iBAAiB,WACvC1C,KAAKD,QAAQI,yBACbH,KAAKD,QAAQK,8BACbJ,KAAKD,QAAQM,yBACbL,KAAKD,QAAQO,wBAGXiE,EAAgBA,KACpBD,EAAS3B,QAAQwB,KACVnE,KAAKmB,YAAYiD,IAAID,IAAYnE,KAAKwE,aAAaL,IACtDnE,KAAK+D,YAAYI,MAMvB,IAAIM,GAAU,EACd,MAAMC,EAAgBA,KACfD,IACHE,sBAAsB,KACpBJ,IACAE,GAAU,IAEZA,GAAU,IAKdF,IAGAlB,OAAOuB,iBAAiB,SAAUF,EAAe,CAAEG,SAAS,IAC5DxB,OAAOuB,iBAAiB,SAAUF,EAAe,CAAEG,SAAS,IAC5DxB,OAAOuB,iBAAiB,oBAAqBF,EAAe,CAAEG,SAAS,GACzE,CAEAL,YAAAA,CAAaL,GACX,MAAMW,EAAOX,EAAQY,wBACfC,EAASC,SAASjF,KAAKD,QAAQE,YAErC,OACE6E,EAAKI,KAAO7B,OAAO8B,YAAcH,GACjCF,EAAKM,SAAWJ,GAChBF,EAAKO,MAAQhC,OAAOiC,WAAaN,GACjCF,EAAKS,QAAUP,CAEnB,CAEA,iBAAMjB,CAAYI,GAChB,IAAInE,KAAKmB,YAAYiD,IAAID,GAAzB,CAEAnE,KAAKmB,YAAYgB,IAAIgC,GACrBA,EAAQjC,UAAUC,IAAInC,KAAKD,QAAQS,cAEnC,IAC0B,QAApB2D,EAAQqB,cACJxF,KAAKyF,UAAUtB,GACQ,UAApBA,EAAQqB,cACXxF,KAAK0F,UAAUvB,GACQ,WAApBA,EAAQqB,cACXxF,KAAK2F,WAAWxB,GACbA,EAAQrB,QAAQ8C,aACnB5F,KAAK6F,oBAAoB1B,GAGjCA,EAAQjC,UAAU4D,OAAO9F,KAAKD,QAAQS,cACtC2D,EAAQjC,UAAUC,IAAInC,KAAKD,QAAQQ,aAGnC4D,EAAQ4B,cACN,IAAIC,YAAY,aAAc,CAC5BC,OAAQ,CAAE9B,aAGhB,CAAE,MAAO+B,GACPlG,KAAKmG,gBAAgBhC,EAAS+B,EAChC,CA3ByC,CA4B3C,CAEAT,SAAAA,CAAU7C,GACR,OAAO,IAAIwD,QAAQ,CAACC,EAASC,KAC3B,MAAMC,EAAU,IAAIC,MAEpBD,EAAQE,OAAS,KAEf,MAAMC,EAAa1G,KAAKwD,sBAAsBZ,GAC9CA,EAAIC,IAAM6D,EAGN9D,EAAIE,QAAQ6D,SACd/D,EAAI+D,OAAS/D,EAAIE,QAAQ6D,QAEvB/D,EAAIE,QAAQ8D,QACdhE,EAAIgE,MAAQhE,EAAIE,QAAQ8D,OAG1B5G,KAAK0D,gBAAgBd,GACrByD,KAGFE,EAAQM,QAAU,KAChBP,EAAO,IAAIQ,MAAM,yBAAyBlE,EAAIE,QAAQD,SAIxD0D,EAAQ1D,IAAM7C,KAAKwD,sBAAsBZ,IAE7C,CAEAY,qBAAAA,CAAsBZ,GACpB,MAAMmE,EAAcnE,EAAIE,QAAQD,IAGhC,OAAI7C,KAAKqB,eAAiBuB,EAAIE,QAAQkE,KAC7BpE,EAAIE,QAAQkE,MAIhBhH,KAAKqB,eAAiBuB,EAAIE,QAAQmE,SAC9BrE,EAAIE,QAAQmE,SAGdF,CACT,CAEArD,eAAAA,CAAgBd,GAEdA,EAAIV,UAAU4D,OAAO,oBAGrBlD,EAAIN,MAAM4E,WAAa,GAGnBlH,KAAKD,QAAQW,eAAiB,IAChCkC,EAAIN,MAAM6E,WAAa,WAAWnH,KAAKD,QAAQW,+BAEnD,CAEAgF,SAAAA,CAAU0B,GACR,OAAO,IAAIhB,QAAQ,CAACC,EAASC,KAEvBc,EAAMtE,QAAQD,MAChBuE,EAAMvE,IAAMuE,EAAMtE,QAAQD,KAIZuE,EAAM1E,iBAAiB,oBAC/BC,QAAQ0E,IACdA,EAAOxE,IAAMwE,EAAOvE,QAAQD,IAC5BwE,EAAOC,gBAAgB,cAIzBF,EAAMG,OAENH,EAAMxC,iBAAiB,aAAc,IAAMyB,IAAW,CAAEmB,MAAM,IAC9DJ,EAAMxC,iBAAiB,QAAS,IAAM0B,EAAO,IAAIQ,MAAM,sBAAuB,CAAEU,MAAM,KAE1F,CAEA7B,UAAAA,CAAW8B,GACT,OAAO,IAAIrB,QAAQ,CAACC,EAASC,KAC3BmB,EAAOhB,OAAS,IAAMJ,IACtBoB,EAAOZ,QAAU,IAAMP,EAAO,IAAIQ,MAAM,uBAExCW,EAAO5E,IAAM4E,EAAO3E,QAAQD,KAEhC,CAEAgD,mBAAAA,CAAoB1B,GAClB,OAAO,IAAIiC,QAAQ,CAACC,EAASC,KAC3B,MAAMC,EAAU,IAAIC,MAEpBD,EAAQE,OAAS,KACf,MAAMb,EACJ5F,KAAKqB,eAAiB8C,EAAQrB,QAAQ4E,OAClCvD,EAAQrB,QAAQ4E,OAChBvD,EAAQrB,QAAQ8C,MAEtBzB,EAAQ7B,MAAMqF,gBAAkB,OAAO/B,KACvCzB,EAAQjC,UAAUC,IAAI,aACtBkE,KAGFE,EAAQM,QAAU,KAChBP,EAAO,IAAIQ,MAAM,oCAAoC3C,EAAQrB,QAAQ8C,WAGvEW,EAAQ1D,IAAMsB,EAAQrB,QAAQ8C,OAElC,CAEAO,eAAAA,CAAgBhC,EAAS+B,GAGvB/B,EAAQjC,UAAU4D,OAAO9F,KAAKD,QAAQS,cACtC2D,EAAQjC,UAAUC,IAAInC,KAAKD,QAAQU,YAGnC,MAAMQ,EAAajB,KAAKiB,WAAW2G,IAAIzD,IAAY,EAC/ClD,EAAajB,KAAKD,QAAQY,eAC5BX,KAAKiB,WAAW4G,IAAI1D,EAASlD,EAAa,GAE1C6G,WACE,KACE9H,KAAKmB,YAAY4G,OAAO5D,GACxBA,EAAQjC,UAAU4D,OAAO9F,KAAKD,QAAQU,YACtCT,KAAK+D,YAAYI,IAEnBnE,KAAKD,QAAQa,YAAcK,EAAa,MAIlB,QAApBkD,EAAQqB,SAAqBrB,EAAQrB,QAAQmE,WAC/C9C,EAAQtB,IAAMsB,EAAQrB,QAAQmE,SAC9B9C,EAAQjC,UAAU4D,OAAO9F,KAAKD,QAAQU,YACtC0D,EAAQjC,UAAUC,IAAInC,KAAKD,QAAQQ,cAIrC4D,EAAQ4B,cACN,IAAIC,YAAY,gBAAiB,CAC/BC,OAAQ,CAAE9B,UAAS+B,YAI3B,CAGA8B,OAAAA,GACmBrG,SAASe,iBAAiB,WACvC1C,KAAKD,QAAQI,sBAAsBH,KAAKD,QAAQQ,wBAChDP,KAAKD,QAAQK,2BAA2BJ,KAAKD,QAAQQ,wBACrDP,KAAKD,QAAQM,sBAAsBL,KAAKD,QAAQQ,wBAChDP,KAAKD,QAAQO,uBAAuBN,KAAKD,QAAQQ,sBAG5CoC,QAAQwB,GAAWnE,KAAK+D,YAAYI,GAC/C,CAEA8D,MAAAA,GACMjI,KAAKgB,UACPhB,KAAKkE,iBAET,CAEAgE,OAAAA,GACMlI,KAAKgB,UACPhB,KAAKgB,SAASmH,aAIhBnI,KAAKiB,WAAWmH,QAChBpI,KAAKmB,YAAYiH,QAGjBzG,SAASM,gBAAgBC,UAAU4D,OAAO,eAC5C,CAGA,WAAOxE,CAAKvB,EAAU,CAAC,GACrB,OAAO,IAAIF,EAASE,EACtB,EAIoB,oBAAXsD,QAA2BA,OAAOgF,cAC3C1G,SAASiD,iBAAiB,mBAAoB,KAC5C/E,EAASyB,Q","sources":["webpack://sabor-con-flow-dance/./src/js/features/lazy-load.js"],"sourcesContent":["/**\n * Enhanced Lazy Loading with Progressive Enhancement\n * Works as fallback when JavaScript is disabled\n */\n\nexport default class LazyLoad {\n  constructor(options = {}) {\n    this.options = {\n      rootMargin: '50px 0px',\n      threshold: 0.01,\n      imageSelector: 'img[data-src], img[data-lazy], img.lazy',\n      backgroundSelector: '[data-bg-src]',\n      videoSelector: 'video[data-src]',\n      iframeSelector: 'iframe[data-src]',\n      loadedClass: 'lazy-loaded',\n      loadingClass: 'lazy-loading',\n      errorClass: 'lazy-error',\n      fadeInDuration: 300,\n      retryAttempts: 3,\n      retryDelay: 1000,\n      enableWebP: true,\n      enablePlaceholders: true,\n      enableNativeLazyLoading: true,\n      ...options,\n    };\n\n    this.observer = null;\n    this.retryCount = new Map();\n    this.loadedItems = new Set();\n    this.webPSupported = false;\n\n    this.init();\n  }\n\n  init() {\n    // Check WebP support\n    this.checkWebPSupport();\n\n    // Add progressive enhancement\n    this.setupProgressiveEnhancement();\n\n    // Initialize lazy loading strategy\n    this.initializeLazyLoading();\n\n    console.log('âœ… Enhanced lazy loading initialized');\n  }\n\n  checkWebPSupport() {\n    if (!this.options.enableWebP) {\n      this.webPSupported = false;\n      return;\n    }\n\n    const canvas = document.createElement('canvas');\n    canvas.width = 1;\n    canvas.height = 1;\n    this.webPSupported = canvas.toDataURL('image/webp').indexOf('image/webp') === 0;\n\n    // Add class to document for CSS targeting\n    document.documentElement.classList.add(this.webPSupported ? 'webp-supported' : 'no-webp');\n  }\n\n  setupProgressiveEnhancement() {\n    // Add enhanced class for CSS targeting\n    document.documentElement.classList.add('js-lazy-load');\n\n    // Add styles for loading states\n    this.addLoadingStyles();\n\n    // Set up placeholder system\n    if (this.options.enablePlaceholders) {\n      this.setupPlaceholders();\n    }\n  }\n\n  addLoadingStyles() {\n    const style = document.createElement('style');\n    style.textContent = `\n      .js-lazy-load img.lazy-loading {\n        opacity: 0;\n        transition: opacity ${this.options.fadeInDuration}ms ease-in-out;\n      }\n      \n      .js-lazy-load img.lazy-loaded {\n        opacity: 1;\n      }\n      \n      .js-lazy-load img.lazy-error {\n        opacity: 0.5;\n        filter: grayscale(100%);\n      }\n      \n      .js-lazy-load .lazy-placeholder {\n        background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);\n        background-size: 200% 100%;\n        animation: loading-shimmer 1.5s infinite;\n      }\n      \n      @keyframes loading-shimmer {\n        0% { background-position: 200% 0; }\n        100% { background-position: -200% 0; }\n      }\n      \n      .js-lazy-load .lazy-placeholder.loaded {\n        animation: none;\n        background: none;\n      }\n      \n      /* Network-aware optimizations */\n      .slow-connection .lazy-placeholder {\n        animation-duration: 3s;\n      }\n      \n      .save-data img[data-src] {\n        background: #f0f0f0;\n      }\n    `;\n    document.head.appendChild(style);\n  }\n\n  setupPlaceholders() {\n    const images = document.querySelectorAll(this.options.imageSelector);\n    images.forEach(img => {\n      if (!img.src && img.dataset.src) {\n        // Add placeholder class\n        img.classList.add('lazy-placeholder');\n\n        // Set low-quality placeholder if available\n        if (img.dataset.placeholder) {\n          img.src = img.dataset.placeholder;\n        } else {\n          // Generate simple placeholder\n          this.generatePlaceholder(img);\n        }\n      }\n    });\n  }\n\n  generatePlaceholder(img) {\n    // Get image dimensions from attributes or compute from aspect ratio\n    const width = img.getAttribute('width') || 400;\n    const height = img.getAttribute('height') || 300;\n\n    // Simple SVG placeholder\n    const placeholder = `data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='${width}' height='${height}' viewBox='0 0 ${width} ${height}'%3E%3Crect width='100%25' height='100%25' fill='%23f0f0f0'/%3E%3C/svg%3E`;\n\n    img.src = placeholder;\n  }\n\n  initializeLazyLoading() {\n    // Use native lazy loading if supported and enabled\n    if (this.options.enableNativeLazyLoading && 'loading' in HTMLImageElement.prototype) {\n      this.initNativeLazyLoading();\n    }\n    // Use Intersection Observer if supported\n    else if ('IntersectionObserver' in window) {\n      this.initIntersectionObserver();\n    }\n    // Fallback to scroll-based lazy loading\n    else {\n      this.initScrollBasedLazyLoading();\n    }\n  }\n\n  initNativeLazyLoading() {\n    const images = document.querySelectorAll(this.options.imageSelector);\n    images.forEach(img => {\n      if (img.dataset.src) {\n        img.src = this.getOptimalImageSource(img);\n        img.loading = 'lazy';\n        img.classList.add(this.options.loadedClass);\n        this.handleImageLoad(img);\n      }\n    });\n\n    // Still use observer for other elements\n    this.initIntersectionObserver();\n  }\n\n  initIntersectionObserver() {\n    this.observer = new IntersectionObserver(\n      entries => {\n        entries.forEach(entry => {\n          if (entry.isIntersecting) {\n            this.loadElement(entry.target);\n            this.observer.unobserve(entry.target);\n          }\n        });\n      },\n      {\n        rootMargin: this.options.rootMargin,\n        threshold: this.options.threshold,\n      }\n    );\n\n    // Observe all lazy load elements\n    this.observeElements();\n  }\n\n  observeElements() {\n    const elements = document.querySelectorAll(`\n      ${this.options.imageSelector},\n      ${this.options.backgroundSelector},\n      ${this.options.videoSelector},\n      ${this.options.iframeSelector}\n    `);\n\n    elements.forEach(element => {\n      if (!this.loadedItems.has(element)) {\n        this.observer.observe(element);\n      }\n    });\n  }\n\n  initScrollBasedLazyLoading() {\n    const elements = document.querySelectorAll(`\n      ${this.options.imageSelector},\n      ${this.options.backgroundSelector},\n      ${this.options.videoSelector},\n      ${this.options.iframeSelector}\n    `);\n\n    const checkElements = () => {\n      elements.forEach(element => {\n        if (!this.loadedItems.has(element) && this.isInViewport(element)) {\n          this.loadElement(element);\n        }\n      });\n    };\n\n    // Throttled scroll handler\n    let ticking = false;\n    const scrollHandler = () => {\n      if (!ticking) {\n        requestAnimationFrame(() => {\n          checkElements();\n          ticking = false;\n        });\n        ticking = true;\n      }\n    };\n\n    // Initial check\n    checkElements();\n\n    // Add event listeners\n    window.addEventListener('scroll', scrollHandler, { passive: true });\n    window.addEventListener('resize', scrollHandler, { passive: true });\n    window.addEventListener('orientationchange', scrollHandler, { passive: true });\n  }\n\n  isInViewport(element) {\n    const rect = element.getBoundingClientRect();\n    const margin = parseInt(this.options.rootMargin);\n\n    return (\n      rect.top <= window.innerHeight + margin &&\n      rect.bottom >= -margin &&\n      rect.left <= window.innerWidth + margin &&\n      rect.right >= -margin\n    );\n  }\n\n  async loadElement(element) {\n    if (this.loadedItems.has(element)) return;\n\n    this.loadedItems.add(element);\n    element.classList.add(this.options.loadingClass);\n\n    try {\n      if (element.tagName === 'IMG') {\n        await this.loadImage(element);\n      } else if (element.tagName === 'VIDEO') {\n        await this.loadVideo(element);\n      } else if (element.tagName === 'IFRAME') {\n        await this.loadIframe(element);\n      } else if (element.dataset.bgSrc) {\n        await this.loadBackgroundImage(element);\n      }\n\n      element.classList.remove(this.options.loadingClass);\n      element.classList.add(this.options.loadedClass);\n\n      // Dispatch custom event\n      element.dispatchEvent(\n        new CustomEvent('lazyloaded', {\n          detail: { element },\n        })\n      );\n    } catch (error) {\n      this.handleLoadError(element, error);\n    }\n  }\n\n  loadImage(img) {\n    return new Promise((resolve, reject) => {\n      const tempImg = new Image();\n\n      tempImg.onload = () => {\n        // Set optimal source\n        const optimalSrc = this.getOptimalImageSource(img);\n        img.src = optimalSrc;\n\n        // Handle srcset and sizes\n        if (img.dataset.srcset) {\n          img.srcset = img.dataset.srcset;\n        }\n        if (img.dataset.sizes) {\n          img.sizes = img.dataset.sizes;\n        }\n\n        this.handleImageLoad(img);\n        resolve();\n      };\n\n      tempImg.onerror = () => {\n        reject(new Error(`Failed to load image: ${img.dataset.src}`));\n      };\n\n      // Start loading\n      tempImg.src = this.getOptimalImageSource(img);\n    });\n  }\n\n  getOptimalImageSource(img) {\n    const originalSrc = img.dataset.src;\n\n    // Use WebP if supported and available\n    if (this.webPSupported && img.dataset.webp) {\n      return img.dataset.webp;\n    }\n\n    // Use fallback if available\n    if (!this.webPSupported && img.dataset.fallback) {\n      return img.dataset.fallback;\n    }\n\n    return originalSrc;\n  }\n\n  handleImageLoad(img) {\n    // Remove placeholder class\n    img.classList.remove('lazy-placeholder');\n\n    // Remove any background placeholder\n    img.style.background = '';\n\n    // Add fade-in effect\n    if (this.options.fadeInDuration > 0) {\n      img.style.transition = `opacity ${this.options.fadeInDuration}ms ease-in-out`;\n    }\n  }\n\n  loadVideo(video) {\n    return new Promise((resolve, reject) => {\n      // Set video source\n      if (video.dataset.src) {\n        video.src = video.dataset.src;\n      }\n\n      // Handle multiple sources\n      const sources = video.querySelectorAll('source[data-src]');\n      sources.forEach(source => {\n        source.src = source.dataset.src;\n        source.removeAttribute('data-src');\n      });\n\n      // Load video\n      video.load();\n\n      video.addEventListener('loadeddata', () => resolve(), { once: true });\n      video.addEventListener('error', () => reject(new Error('Video load failed')), { once: true });\n    });\n  }\n\n  loadIframe(iframe) {\n    return new Promise((resolve, reject) => {\n      iframe.onload = () => resolve();\n      iframe.onerror = () => reject(new Error('Iframe load failed'));\n\n      iframe.src = iframe.dataset.src;\n    });\n  }\n\n  loadBackgroundImage(element) {\n    return new Promise((resolve, reject) => {\n      const tempImg = new Image();\n\n      tempImg.onload = () => {\n        const bgSrc =\n          this.webPSupported && element.dataset.bgWebp\n            ? element.dataset.bgWebp\n            : element.dataset.bgSrc;\n\n        element.style.backgroundImage = `url(${bgSrc})`;\n        element.classList.add('bg-loaded');\n        resolve();\n      };\n\n      tempImg.onerror = () => {\n        reject(new Error(`Failed to load background image: ${element.dataset.bgSrc}`));\n      };\n\n      tempImg.src = element.dataset.bgSrc;\n    });\n  }\n\n  handleLoadError(element, error) {\n    console.warn('Lazy load error:', error);\n\n    element.classList.remove(this.options.loadingClass);\n    element.classList.add(this.options.errorClass);\n\n    // Retry logic\n    const retryCount = this.retryCount.get(element) || 0;\n    if (retryCount < this.options.retryAttempts) {\n      this.retryCount.set(element, retryCount + 1);\n\n      setTimeout(\n        () => {\n          this.loadedItems.delete(element);\n          element.classList.remove(this.options.errorClass);\n          this.loadElement(element);\n        },\n        this.options.retryDelay * (retryCount + 1)\n      );\n    } else {\n      // Try fallback image for images\n      if (element.tagName === 'IMG' && element.dataset.fallback) {\n        element.src = element.dataset.fallback;\n        element.classList.remove(this.options.errorClass);\n        element.classList.add(this.options.loadedClass);\n      }\n\n      // Dispatch error event\n      element.dispatchEvent(\n        new CustomEvent('lazyloaderror', {\n          detail: { element, error },\n        })\n      );\n    }\n  }\n\n  // Public API methods\n  loadAll() {\n    const elements = document.querySelectorAll(`\n      ${this.options.imageSelector}:not(.${this.options.loadedClass}),\n      ${this.options.backgroundSelector}:not(.${this.options.loadedClass}),\n      ${this.options.videoSelector}:not(.${this.options.loadedClass}),\n      ${this.options.iframeSelector}:not(.${this.options.loadedClass})\n    `);\n\n    elements.forEach(element => this.loadElement(element));\n  }\n\n  update() {\n    if (this.observer) {\n      this.observeElements();\n    }\n  }\n\n  destroy() {\n    if (this.observer) {\n      this.observer.disconnect();\n    }\n\n    // Clear retry counts\n    this.retryCount.clear();\n    this.loadedItems.clear();\n\n    // Remove enhanced class\n    document.documentElement.classList.remove('js-lazy-load');\n  }\n\n  // Static factory method\n  static init(options = {}) {\n    return new LazyLoad(options);\n  }\n}\n\n// Auto-initialize if not using module system\nif (typeof window !== 'undefined' && !window.moduleSystem) {\n  document.addEventListener('DOMContentLoaded', () => {\n    LazyLoad.init();\n  });\n}\n"],"names":["LazyLoad","constructor","options","this","rootMargin","threshold","imageSelector","backgroundSelector","videoSelector","iframeSelector","loadedClass","loadingClass","errorClass","fadeInDuration","retryAttempts","retryDelay","enableWebP","enablePlaceholders","enableNativeLazyLoading","observer","retryCount","Map","loadedItems","Set","webPSupported","init","checkWebPSupport","setupProgressiveEnhancement","initializeLazyLoading","canvas","document","createElement","width","height","toDataURL","indexOf","documentElement","classList","add","addLoadingStyles","setupPlaceholders","style","textContent","head","appendChild","querySelectorAll","forEach","img","src","dataset","placeholder","generatePlaceholder","getAttribute","HTMLImageElement","prototype","initNativeLazyLoading","window","initIntersectionObserver","initScrollBasedLazyLoading","getOptimalImageSource","loading","handleImageLoad","IntersectionObserver","entries","entry","isIntersecting","loadElement","target","unobserve","observeElements","element","has","observe","elements","checkElements","isInViewport","ticking","scrollHandler","requestAnimationFrame","addEventListener","passive","rect","getBoundingClientRect","margin","parseInt","top","innerHeight","bottom","left","innerWidth","right","tagName","loadImage","loadVideo","loadIframe","bgSrc","loadBackgroundImage","remove","dispatchEvent","CustomEvent","detail","error","handleLoadError","Promise","resolve","reject","tempImg","Image","onload","optimalSrc","srcset","sizes","onerror","Error","originalSrc","webp","fallback","background","transition","video","source","removeAttribute","load","once","iframe","bgWebp","backgroundImage","get","set","setTimeout","delete","loadAll","update","destroy","disconnect","clear","moduleSystem"],"sourceRoot":""}