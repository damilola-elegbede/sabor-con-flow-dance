{"version":3,"file":"performance-monitor.91f0afdb.js","mappings":"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","sources":["webpack://sabor-con-flow-dance/./src/js/features/performance-monitor.js"],"sourcesContent":["/**\n * Performance Monitor - Core Web Vitals and Custom Metrics\n * Tracks performance metrics and sends to analytics\n */\n\nexport default class PerformanceMonitor {\n  constructor(options = {}) {\n    this.options = {\n      enableWebVitals: true,\n      enableCustomMetrics: true,\n      enableNavigationTiming: true,\n      enableResourceTiming: true,\n      enableUserTiming: true,\n      sampleRate: 1.0, // 100% sampling by default\n      bufferSize: 100,\n      sendInterval: 30000, // 30 seconds\n      endpoint: '/api/performance', // Custom endpoint for performance data\n      ...options,\n    };\n\n    this.metrics = new Map();\n    this.buffer = [];\n    this.observers = new Map();\n    this.startTime = performance.now();\n\n    this.init();\n  }\n\n  init() {\n    // Only monitor if we should sample this session\n    if (Math.random() > this.options.sampleRate) {\n      return;\n    }\n\n    this.setupWebVitals();\n    this.setupCustomMetrics();\n    this.setupNavigationTiming();\n    this.setupResourceTiming();\n    this.setupUserTiming();\n    this.setupSendInterval();\n\n    console.log('ðŸ” Performance monitoring started');\n  }\n\n  setupWebVitals() {\n    if (!this.options.enableWebVitals) return;\n\n    // Track Core Web Vitals\n    this.trackCLS();\n    this.trackFID();\n    this.trackLCP();\n    this.trackFCP();\n    this.trackTTFB();\n  }\n\n  trackCLS() {\n    if (!('PerformanceObserver' in window)) return;\n\n    try {\n      const clsObserver = new PerformanceObserver(list => {\n        for (const entry of list.getEntries()) {\n          if (!entry.hadRecentInput) {\n            this.recordMetric('CLS', {\n              value: entry.value,\n              sources:\n                entry.sources?.map(source => ({\n                  element: source.node?.tagName || 'unknown',\n                  previousRect: source.previousRect,\n                  currentRect: source.currentRect,\n                })) || [],\n            });\n          }\n        }\n      });\n\n      clsObserver.observe({ entryTypes: ['layout-shift'] });\n      this.observers.set('cls', clsObserver);\n    } catch (e) {\n      console.warn('CLS tracking not supported');\n    }\n  }\n\n  trackFID() {\n    if (!('PerformanceObserver' in window)) return;\n\n    try {\n      const fidObserver = new PerformanceObserver(list => {\n        for (const entry of list.getEntries()) {\n          this.recordMetric('FID', {\n            value: entry.processingStart - entry.startTime,\n            startTime: entry.startTime,\n            processingStart: entry.processingStart,\n            processingEnd: entry.processingEnd,\n          });\n        }\n      });\n\n      fidObserver.observe({ entryTypes: ['first-input'] });\n      this.observers.set('fid', fidObserver);\n    } catch (e) {\n      console.warn('FID tracking not supported');\n    }\n  }\n\n  trackLCP() {\n    if (!('PerformanceObserver' in window)) return;\n\n    try {\n      const lcpObserver = new PerformanceObserver(list => {\n        const entries = list.getEntries();\n        const lastEntry = entries[entries.length - 1];\n\n        this.recordMetric('LCP', {\n          value: lastEntry.startTime,\n          element: lastEntry.element?.tagName || 'unknown',\n          url: lastEntry.url || '',\n          size: lastEntry.size || 0,\n        });\n      });\n\n      lcpObserver.observe({ entryTypes: ['largest-contentful-paint'] });\n      this.observers.set('lcp', lcpObserver);\n    } catch (e) {\n      console.warn('LCP tracking not supported');\n    }\n  }\n\n  trackFCP() {\n    if (!('PerformanceObserver' in window)) return;\n\n    try {\n      const fcpObserver = new PerformanceObserver(list => {\n        for (const entry of list.getEntries()) {\n          if (entry.name === 'first-contentful-paint') {\n            this.recordMetric('FCP', {\n              value: entry.startTime,\n            });\n          }\n        }\n      });\n\n      fcpObserver.observe({ entryTypes: ['paint'] });\n      this.observers.set('fcp', fcpObserver);\n    } catch (e) {\n      console.warn('FCP tracking not supported');\n    }\n  }\n\n  trackTTFB() {\n    if (!('PerformanceObserver' in window)) return;\n\n    try {\n      const navigationObserver = new PerformanceObserver(list => {\n        for (const entry of list.getEntries()) {\n          this.recordMetric('TTFB', {\n            value: entry.responseStart - entry.requestStart,\n            dns: entry.domainLookupEnd - entry.domainLookupStart,\n            tcp: entry.connectEnd - entry.connectStart,\n            request: entry.responseStart - entry.requestStart,\n            response: entry.responseEnd - entry.responseStart,\n          });\n        }\n      });\n\n      navigationObserver.observe({ entryTypes: ['navigation'] });\n      this.observers.set('navigation', navigationObserver);\n    } catch (e) {\n      console.warn('Navigation timing not supported');\n    }\n  }\n\n  setupCustomMetrics() {\n    if (!this.options.enableCustomMetrics) return;\n\n    // Track JavaScript bundle load times\n    this.trackBundleLoadTimes();\n\n    // Track critical resource loading\n    this.trackCriticalResources();\n\n    // Track user interactions\n    this.trackUserInteractions();\n\n    // Track memory usage\n    this.trackMemoryUsage();\n  }\n\n  trackBundleLoadTimes() {\n    // Track when main bundle loads\n    const _bundleStart = performance.mark('bundle-start');\n\n    window.addEventListener('load', () => {\n      performance.mark('bundle-end');\n      const bundleTime = performance.measure('bundle-load', 'bundle-start', 'bundle-end');\n\n      this.recordMetric('Bundle Load Time', {\n        value: bundleTime.duration,\n        bundles: this.getLoadedBundles(),\n      });\n    });\n  }\n\n  getLoadedBundles() {\n    const scripts = Array.from(document.querySelectorAll('script[src]'));\n    return scripts.map(script => ({\n      src: script.src,\n      async: script.async,\n      defer: script.defer,\n    }));\n  }\n\n  trackCriticalResources() {\n    // Track hero image/video loading\n    const heroMedia = document.querySelector('.hero img, .hero video');\n    if (heroMedia) {\n      const startTime = performance.now();\n\n      const trackLoad = () => {\n        const loadTime = performance.now() - startTime;\n        this.recordMetric('Hero Media Load', {\n          value: loadTime,\n          type: heroMedia.tagName.toLowerCase(),\n          src: heroMedia.src || heroMedia.currentSrc,\n        });\n      };\n\n      if (heroMedia.complete || heroMedia.readyState >= 2) {\n        trackLoad();\n      } else {\n        heroMedia.addEventListener('load', trackLoad);\n        heroMedia.addEventListener('loadeddata', trackLoad);\n      }\n    }\n\n    // Track font loading\n    if ('fonts' in document) {\n      document.fonts.ready.then(() => {\n        this.recordMetric('Fonts Loaded', {\n          value: performance.now() - this.startTime,\n          count: document.fonts.size,\n        });\n      });\n    }\n  }\n\n  trackUserInteractions() {\n    // Track time to first interaction\n    let firstInteraction = null;\n\n    const interactions = ['click', 'touchstart', 'keydown', 'scroll'];\n\n    const trackFirstInteraction = event => {\n      if (!firstInteraction) {\n        firstInteraction = performance.now();\n        this.recordMetric('Time to First Interaction', {\n          value: firstInteraction - this.startTime,\n          type: event.type,\n        });\n\n        // Remove listeners after first interaction\n        interactions.forEach(type => {\n          document.removeEventListener(type, trackFirstInteraction);\n        });\n      }\n    };\n\n    interactions.forEach(type => {\n      document.addEventListener(type, trackFirstInteraction, {\n        passive: true,\n        once: true,\n      });\n    });\n\n    // Track scroll depth\n    this.trackScrollDepth();\n  }\n\n  trackScrollDepth() {\n    let maxScrollDepth = 0;\n    let scrollTimer = null;\n\n    const trackScroll = () => {\n      const scrollTop = window.pageYOffset;\n      const documentHeight = document.documentElement.scrollHeight - window.innerHeight;\n      const scrollPercent = Math.round((scrollTop / documentHeight) * 100);\n\n      if (scrollPercent > maxScrollDepth) {\n        maxScrollDepth = scrollPercent;\n      }\n\n      // Debounce scroll tracking\n      clearTimeout(scrollTimer);\n      scrollTimer = setTimeout(() => {\n        this.recordMetric('Scroll Depth', {\n          value: maxScrollDepth,\n          timestamp: performance.now(),\n        });\n      }, 500);\n    };\n\n    window.addEventListener('scroll', trackScroll, { passive: true });\n\n    // Track final scroll depth on page unload\n    window.addEventListener('beforeunload', () => {\n      this.recordMetric('Final Scroll Depth', {\n        value: maxScrollDepth,\n      });\n    });\n  }\n\n  trackMemoryUsage() {\n    if ('memory' in performance) {\n      const trackMemory = () => {\n        this.recordMetric('Memory Usage', {\n          used: performance.memory.usedJSHeapSize,\n          total: performance.memory.totalJSHeapSize,\n          limit: performance.memory.jsHeapSizeLimit,\n        });\n      };\n\n      // Track initial memory\n      trackMemory();\n\n      // Track memory periodically\n      setInterval(trackMemory, 60000); // Every minute\n    }\n  }\n\n  setupNavigationTiming() {\n    if (!this.options.enableNavigationTiming) return;\n\n    window.addEventListener('load', () => {\n      const navigation = performance.getEntriesByType('navigation')[0];\n      if (navigation) {\n        this.recordMetric('Navigation Timing', {\n          dns: navigation.domainLookupEnd - navigation.domainLookupStart,\n          tcp: navigation.connectEnd - navigation.connectStart,\n          ttfb: navigation.responseStart - navigation.requestStart,\n          download: navigation.responseEnd - navigation.responseStart,\n          domParsing: navigation.domContentLoadedEventStart - navigation.responseEnd,\n          resourceLoading: navigation.loadEventStart - navigation.domContentLoadedEventStart,\n        });\n      }\n    });\n  }\n\n  setupResourceTiming() {\n    if (!this.options.enableResourceTiming) return;\n\n    // Track slow resources\n    const slowResourceThreshold = 1000; // 1 second\n\n    const checkResources = () => {\n      const resources = performance.getEntriesByType('resource');\n      const slowResources = resources.filter(resource => resource.duration > slowResourceThreshold);\n\n      if (slowResources.length > 0) {\n        this.recordMetric('Slow Resources', {\n          count: slowResources.length,\n          resources: slowResources.map(resource => ({\n            name: resource.name,\n            duration: resource.duration,\n            size: resource.transferSize,\n            type: resource.initiatorType,\n          })),\n        });\n      }\n    };\n\n    window.addEventListener('load', () => {\n      setTimeout(checkResources, 1000);\n    });\n  }\n\n  setupUserTiming() {\n    if (!this.options.enableUserTiming) return;\n\n    // Track custom performance marks and measures\n    const checkUserTiming = () => {\n      const marks = performance.getEntriesByType('mark');\n      const measures = performance.getEntriesByType('measure');\n\n      if (marks.length > 0 || measures.length > 0) {\n        this.recordMetric('User Timing', {\n          marks: marks.map(mark => ({\n            name: mark.name,\n            startTime: mark.startTime,\n          })),\n          measures: measures.map(measure => ({\n            name: measure.name,\n            duration: measure.duration,\n            startTime: measure.startTime,\n          })),\n        });\n      }\n    };\n\n    window.addEventListener('load', () => {\n      setTimeout(checkUserTiming, 2000);\n    });\n  }\n\n  recordMetric(name, data) {\n    const metric = {\n      name,\n      data,\n      timestamp: Date.now(),\n      url: window.location.href,\n      userAgent: navigator.userAgent,\n      connection: this.getConnectionInfo(),\n    };\n\n    this.metrics.set(name, metric);\n    this.buffer.push(metric);\n\n    // Log in development\n    if (process.env.NODE_ENV === 'development') {\n      console.log(`ðŸ“Š ${name}:`, data);\n    }\n\n    // Send immediately for critical metrics\n    if (this.isCriticalMetric(name)) {\n      this.sendMetrics([metric]);\n    }\n  }\n\n  getConnectionInfo() {\n    if ('connection' in navigator) {\n      const conn = navigator.connection;\n      return {\n        effectiveType: conn.effectiveType,\n        downlink: conn.downlink,\n        rtt: conn.rtt,\n        saveData: conn.saveData,\n      };\n    }\n    return null;\n  }\n\n  isCriticalMetric(name) {\n    const criticalMetrics = ['CLS', 'FID', 'LCP'];\n    return criticalMetrics.includes(name);\n  }\n\n  setupSendInterval() {\n    // Send metrics periodically\n    setInterval(() => {\n      if (this.buffer.length > 0) {\n        this.sendBufferedMetrics();\n      }\n    }, this.options.sendInterval);\n\n    // Send metrics on page unload\n    window.addEventListener('beforeunload', () => {\n      this.sendBufferedMetrics(true);\n    });\n\n    // Send metrics when buffer is full\n    this.checkBufferSize();\n  }\n\n  checkBufferSize() {\n    if (this.buffer.length >= this.options.bufferSize) {\n      this.sendBufferedMetrics();\n    }\n  }\n\n  sendBufferedMetrics(useBeacon = false) {\n    if (this.buffer.length === 0) return;\n\n    const metrics = [...this.buffer];\n    this.buffer = [];\n\n    this.sendMetrics(metrics, useBeacon);\n  }\n\n  async sendMetrics(metrics, useBeacon = false) {\n    const payload = {\n      metrics,\n      session: this.getSessionId(),\n      page: {\n        url: window.location.href,\n        title: document.title,\n        referrer: document.referrer,\n      },\n      timestamp: Date.now(),\n    };\n\n    try {\n      if (useBeacon && 'sendBeacon' in navigator) {\n        // Use sendBeacon for reliable delivery on page unload\n        navigator.sendBeacon(this.options.endpoint, JSON.stringify(payload));\n      } else {\n        // Send to analytics\n        this.sendToAnalytics(metrics);\n\n        // Send to custom endpoint if configured\n        if (this.options.endpoint) {\n          await fetch(this.options.endpoint, {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json',\n            },\n            body: JSON.stringify(payload),\n            keepalive: true,\n          });\n        }\n      }\n    } catch (error) {\n      console.warn('Failed to send performance metrics:', error);\n    }\n  }\n\n  sendToAnalytics(metrics) {\n    if (!window.gtag) return;\n\n    metrics.forEach(metric => {\n      if (metric.data.value !== undefined) {\n        window.gtag('event', 'web_vitals', {\n          name: metric.name,\n          value: Math.round(metric.data.value),\n          metric_id: this.generateMetricId(metric),\n          custom_parameters: metric.data,\n        });\n      }\n    });\n  }\n\n  generateMetricId(metric) {\n    return `${metric.name}_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n  }\n\n  getSessionId() {\n    if (!this.sessionId) {\n      this.sessionId = `${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    }\n    return this.sessionId;\n  }\n\n  // Public API methods\n  trackCustomEvent(name, data = {}) {\n    this.recordMetric(`Custom: ${name}`, data);\n  }\n\n  mark(name) {\n    performance.mark(name);\n  }\n\n  measure(name, startMark, endMark) {\n    const measure = performance.measure(name, startMark, endMark);\n    this.recordMetric(`Measure: ${name}`, {\n      value: measure.duration,\n      startTime: measure.startTime,\n    });\n    return measure;\n  }\n\n  getMetrics() {\n    return Object.fromEntries(this.metrics);\n  }\n\n  start() {\n    this.init();\n  }\n\n  stop() {\n    // Disconnect all observers\n    this.observers.forEach(observer => observer.disconnect());\n    this.observers.clear();\n\n    // Send remaining buffered metrics\n    this.sendBufferedMetrics();\n  }\n\n  // Static factory method\n  static init(options = {}) {\n    return new PerformanceMonitor(options);\n  }\n}\n\n// Auto-initialize if not using module system\nif (typeof window !== 'undefined' && !window.moduleSystem) {\n  document.addEventListener('DOMContentLoaded', () => {\n    PerformanceMonitor.init();\n  });\n}\n"],"names":["PerformanceMonitor","constructor","options","this","enableWebVitals","enableCustomMetrics","enableNavigationTiming","enableResourceTiming","enableUserTiming","sampleRate","bufferSize","sendInterval","endpoint","metrics","Map","buffer","observers","startTime","performance","now","init","Math","random","setupWebVitals","setupCustomMetrics","setupNavigationTiming","setupResourceTiming","setupUserTiming","setupSendInterval","trackCLS","trackFID","trackLCP","trackFCP","trackTTFB","window","clsObserver","PerformanceObserver","list","entry","getEntries","hadRecentInput","recordMetric","value","sources","map","source","element","node","tagName","previousRect","currentRect","observe","entryTypes","set","e","fidObserver","processingStart","processingEnd","lcpObserver","entries","lastEntry","length","url","size","fcpObserver","name","navigationObserver","responseStart","requestStart","dns","domainLookupEnd","domainLookupStart","tcp","connectEnd","connectStart","request","response","responseEnd","trackBundleLoadTimes","trackCriticalResources","trackUserInteractions","trackMemoryUsage","mark","addEventListener","bundleTime","measure","duration","bundles","getLoadedBundles","Array","from","document","querySelectorAll","script","src","async","defer","heroMedia","querySelector","trackLoad","loadTime","type","toLowerCase","currentSrc","complete","readyState","fonts","ready","then","count","firstInteraction","interactions","trackFirstInteraction","event","forEach","removeEventListener","passive","once","trackScrollDepth","maxScrollDepth","scrollTimer","trackScroll","scrollTop","pageYOffset","documentHeight","documentElement","scrollHeight","innerHeight","scrollPercent","round","clearTimeout","setTimeout","timestamp","trackMemory","used","memory","usedJSHeapSize","total","totalJSHeapSize","limit","jsHeapSizeLimit","setInterval","navigation","getEntriesByType","ttfb","download","domParsing","domContentLoadedEventStart","resourceLoading","loadEventStart","checkResources","slowResources","filter","resource","resources","transferSize","initiatorType","checkUserTiming","marks","measures","data","metric","Date","location","href","userAgent","navigator","connection","getConnectionInfo","push","isCriticalMetric","sendMetrics","conn","effectiveType","downlink","rtt","saveData","includes","sendBufferedMetrics","checkBufferSize","useBeacon","payload","session","getSessionId","page","title","referrer","sendBeacon","JSON","stringify","sendToAnalytics","fetch","method","headers","body","keepalive","error","gtag","undefined","metric_id","generateMetricId","custom_parameters","toString","substr","sessionId","trackCustomEvent","startMark","endMark","getMetrics","Object","fromEntries","start","stop","observer","disconnect","clear","moduleSystem"],"sourceRoot":""}