{% extends 'base.html' %}
{% load static %}

{% block title %}Contact Us - Sabor con Flow Dance{% endblock %}

{% block meta_description %}Get in touch with Sabor con Flow Dance. Email us for class info, join our WhatsApp community, or follow us on social media.{% endblock %}

{% block meta_keywords %}contact Sabor con Flow, dance class inquiries Boulder, WhatsApp dance community, Cuban salsa contact information{% endblock %}

{% block canonical_url %}{{ request.scheme }}://{{ request.get_host }}{% url 'core:contact' %}{% endblock %}

{% block og_title %}Contact Us - Sabor con Flow Dance{% endblock %}
{% block og_description %}Get in touch with Sabor con Flow Dance. Email us for class info, join our WhatsApp community, or follow us on social media.{% endblock %}

{% block content %}
<div class="container main-content-contact">
    <h1 class="page-title">Get In Touch</h1>
    
    <!-- Quick Booking Section -->
    <div class="contact-booking-section" style="margin-bottom: 3rem; text-align: center; padding: 2rem; background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%); border-radius: 12px; border: 1px solid #C7B375;">
        <h2 style="color: #C7B375; font-family: var(--font-heading, 'Playfair Display', serif); margin-bottom: 1rem;">Book a Private Lesson</h2>
        <p style="color: #FFFFFF; margin-bottom: 1.5rem; font-size: 1.1rem;">
            Ready to start your dance journey? Schedule a private lesson directly with us.
        </p>
        {% include 'components/calendly_widget.html' with type='popup' text='Schedule Your Lesson' %}
    </div>

    <div class="contact-section">
        <h2 class="contact-title">Email Us</h2>
        <div class="contact-item">
            <div class="contact-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="36" height="36" fill="#C7B375">
                    <path d="M0 0h24v24H0z" fill="none"/>
                    <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H4V8l8 5 8-5v10zm-8-7L4 6h16l-8 5z"/>
                </svg>
            </div>
            <div>
                <p>For class information, booking, and general inquiries:</p>
                <a href="mailto:saborconflowdance@gmail.com" class="contact-link">saborconflowdance@gmail.com</a>
            </div>
        </div>
    </div>

    <div class="contact-section">
        <h2 class="contact-title">Join Our WhatsApp Community</h2>
        <div class="contact-item">
            <div class="contact-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="36" height="36">
                    <rect width="24" height="24" rx="6" ry="6" fill="#25D366"/>
                    <path fill="#ffffff" d="M17.6 6.2c-1.5-1.5-3.4-2.3-5.5-2.3-4.3 0-7.8 3.5-7.8 7.8 0 1.4.4 2.7 1 3.9l-1.1 4 4.1-1.1c1.1.6 2.4 1 3.7 1 4.3 0 7.8-3.5 7.8-7.8.1-2.1-.7-4-2.2-5.5zm-5.5 12c-1.2 0-2.3-.3-3.3-.9l-.2-.1-2.4.6.6-2.3-.2-.2c-.6-1-1-2.2-1-3.4 0-3.6 2.9-6.5 6.5-6.5 1.7 0 3.3.7 4.6 1.9 1.2 1.2 1.9 2.8 1.9 4.6-.1 3.5-3 6.3-6.5 6.3zm3.6-4.9c-.2-.1-1.1-.6-1.3-.6-.2-.1-.3-.1-.4.1-.1.2-.5.6-.6.8-.1.1-.2.1-.4 0-.6-.3-1.3-.7-1.9-1.3-.8-.7-1.2-1.5-1.3-1.7-.1-.2 0-.3.1-.4l.3-.3s.1-.2.2-.3c.1-.1.1-.2.1-.3 0-.1 0-.2-.1-.3l-.6-1.4c-.1-.3-.3-.3-.4-.3h-.4c-.1 0-.3.1-.5.2-.2.1-.6.6-.6 1.4s.6 1.6.7 1.7c.1.1 1.3 2 3.2 2.8.4.2.8.3 1 .3.2.1.5.1.7.1.2 0 .6-.3.7-.5.1-.3.1-.5.1-.6-.1-.1-.2-.1-.4-.2z"/>
                </svg>
            </div>
            <div>
                <p>Stay updated with class schedules, events, and connect with fellow dancers in our community:</p>
                <a href="https://chat.whatsapp.com/GaZONDA1HgFG7C8djihJ1x" target="_blank" class="whatsapp-button">
                    Join WhatsApp Group
                </a>
            </div>
        </div>
    </div>

    <!-- Google Maps Section -->
    {% if ENABLE_GOOGLE_MAPS and GOOGLE_MAPS_API_KEY %}
    <div class="sabor-map-section">
        <div class="sabor-map-header">
            <h2>Visit Our Studio</h2>
            <p>Find us at Avalon Ballroom in the heart of Boulder</p>
        </div>
        <div id="sabor-google-map" class="loading" 
             role="application" 
             aria-label="Interactive map showing Sabor con Flow Dance studio location"
             tabindex="0">
            <!-- Map will be loaded here -->
        </div>
    </div>
    {% endif %}

    <div class="contact-section">
        <h2 class="contact-title">Social Media</h2>
        <div class="contact-item">
            <div class="contact-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="36" height="36">
                    <defs>
                        <linearGradient id="instaContactGradient" x1="0%" y1="100%" x2="100%" y2="0%">
                          <stop offset="0%" stop-color="#FEDA75"/><stop offset="25%" stop-color="#F58529"/><stop offset="50%" stop-color="#DD2A7B"/><stop offset="75%" stop-color="#833AB4"/><stop offset="100%" stop-color="#405DE6"/>
                        </linearGradient>
                    </defs>
                    <rect width="24" height="24" rx="6" ry="6" fill="url(#instaContactGradient)"/>
                    <path fill="none" stroke="#ffffff" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"
                          d="M12 16.14a4.14 4.14 0 100-8.28 4.14 4.14 0 000 8.28z"/>
                    <circle fill="#ffffff" cx="17.3" cy="6.7" r="1.1"/>
                    <rect x="3.5" y="3.5" width="17" height="17" rx="4" ry="4" fill="none" stroke="#ffffff" stroke-width="1.8"/>
                </svg>
            </div>
            <div>
                <p>Follow us on Instagram for photos, videos, and announcements:</p>
                <a href="https://www.instagram.com/saborconflow.dance/" target="_blank" class="contact-link">@saborconflow.dance</a>
            </div>
        </div>
        <div class="contact-item">
            <div class="contact-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="36" height="36">
                    <rect width="24" height="24" rx="6" ry="6" fill="#1877F2"/>
                    <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z" fill="#ffffff"/>
                </svg>
            </div>
            <div>
                <p>Connect with us on Facebook:</p>
                <a href="https://www.facebook.com/profile.php?id=61575502290591" target="_blank" class="contact-link">Sabor Con Flow Dance</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<!-- Google Maps Styles -->
{% if ENABLE_GOOGLE_MAPS and GOOGLE_MAPS_API_KEY %}
<link rel="stylesheet" href="{% static 'css/google-maps.css' %}">
{% endif %}
{% endblock %}

{% block extra_js %}
<!-- Calendly Integration JavaScript -->
<script src="{% static 'js/calendly.js' %}" defer></script>

<!-- Google Maps Integration -->
{% if ENABLE_GOOGLE_MAPS and GOOGLE_MAPS_API_KEY %}
<!-- Google Maps API -->
<script>
    // Global configuration for Google Maps
    window.SABOR_MAP_CONFIG = {
        apiKey: '{{ GOOGLE_MAPS_API_KEY }}',
        studioLocation: {
            lat: {{ STUDIO_COORDINATES.latitude }},
            lng: {{ STUDIO_COORDINATES.longitude }}
        },
        zoomLevel: {{ GOOGLE_MAPS_ZOOM_LEVEL }},
        businessInfo: {
            name: '{{ BUSINESS_INFO.name }}',
            address: '{{ BUSINESS_INFO.address }}',
            phone: '{{ BUSINESS_INFO.phone }}',
            email: '{{ BUSINESS_INFO.email }}'
        }
    };
</script>
<script src="{% static 'js/google-maps.js' %}" defer></script>
<script src="https://maps.googleapis.com/maps/api/js?key={{ GOOGLE_MAPS_API_KEY }}&callback=initSaborMap&libraries=&v=weekly&loading=async" 
        async defer 
        onerror="handleMapError()"></script>
{% endif %}

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Track contact page visits
    if (typeof gtag === 'function') {
        gtag('event', 'page_view', {
            'page_title': 'Contact Us',
            'page_location': window.location.href
        });
    }
    
    // Listen for Calendly events from contact page
    document.addEventListener('calendly:booking_completed', function(event) {
        console.log('Booking completed from contact page!', event.detail);
        
        // Track contact page conversion
        if (typeof gtag === 'function') {
            gtag('event', 'conversion', {
                'send_to': 'AW-CONVERSION_ID/CONVERSION_LABEL',
                'event_category': 'contact_page',
                'event_label': 'booking_from_contact'
            });
        }
    });
    
    // Google Maps event tracking
    {% if ENABLE_GOOGLE_MAPS and GOOGLE_MAPS_API_KEY %}
    document.addEventListener('sabor:map:mapLoaded', function(event) {
        console.log('Google Maps loaded successfully');
        
        // Remove loading state
        const mapContainer = document.getElementById('sabor-google-map');
        if (mapContainer) {
            mapContainer.classList.remove('loading');
        }
        
        // Track map load
        if (typeof gtag === 'function') {
            gtag('event', 'map_loaded', {
                'event_category': 'google_maps',
                'event_label': 'contact_page_map',
                'value': 1
            });
        }
    });
    
    document.addEventListener('sabor:map:infoWindowOpened', function(event) {
        if (typeof gtag === 'function') {
            gtag('event', 'info_window_opened', {
                'event_category': 'google_maps',
                'event_label': 'studio_info',
                'value': 1
            });
        }
    });
    
    document.addEventListener('sabor:map:mapError', function(event) {
        console.error('Google Maps failed to load');
        
        if (typeof gtag === 'function') {
            gtag('event', 'map_error', {
                'event_category': 'google_maps',
                'event_label': 'load_failed',
                'value': 1
            });
        }
    });
    {% endif %}
});
</script>
{% endblock %} 